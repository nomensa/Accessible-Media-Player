/**
*    The Nomensa accessible media player is a flexible multimedia solution for websites and intranets.  
*    The core player consists of JavaScript wrapper responsible for generating an accessible HTML toolbar 
*    for interacting with a media player of your choice. We currently provide support for YouTube (default),
*    Vimeo and JWPlayer although it should be possible to integrate the player with almost any media player on
*    the web (provided a JavaScript api for the player in question is available).
*    
*    Copyright (C) 2012  Nomensa Ltd
*
*    This program is free software: you can redistribute it and/or modify
*    it under the terms of the GNU General Public License as published by
*    the Free Software Foundation, either version 3 of the License, or
*    (at your option) any later version.
*
*    This program is distributed in the hope that it will be useful,
*    but WITHOUT ANY WARRANTY; without even the implied warranty of
*    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*    GNU General Public License for more details.
*
*    You should have received a copy of the GNU General Public License
*    along with this program.  If not, see <http://www.gnu.org/licenses/>.
**/

// Main config required for the nomensa media player to work with the jw player
var jwconfig={init:function(player){var self=this;this.player=player;this.cue();this.player.onPlay(function(e){self.setSliderTimeout();if(self.config.buttons.toggle){self.$html.find('.play').removeClass('play').addClass('pause').text('Pause');}if(self.config.captionsOn&&self.captions){self.setCaptionTimeout();}});this.player.onPause(function(e){self.clearSliderTimeout();if(self.config.buttons.toggle){self.$html.find('.pause').removeClass('pause').addClass('play').text('Play');}if(self.config.captionsOn&&self.captions){self.clearCaptionTimeout();}});if(this.config.repeat===true){this.player.onComplete(function(e){self.play();});}},getURL:function(){return this.config.url;},play:function(){this.player.play();this.setSliderTimeout();if(this.config.captionsOn&&this.captions){this.setCaptionTimeout();}},pause:function(){this.player.pause();this.clearSliderTimeout();if(this.config.captionsOn&&this.captions){this.clearCaptionTimeout();}},mute:function(){var $button=this.$html.find('button.mute');this.player.setMute();if($button.hasClass('muted')){$button.removeClass('muted');}else{$button.addClass('muted');}},getCurrentTime:function(){return this.player.getPosition();},getBytesLoaded:function(){return this.player.getBuffer();},getBytesTotal:function(){return 100;},seek:function(time){this.player.seek(time);if(this.config.captionsOn&&this.captions){this.$html.find('.caption').remove();this.clearCaptionTimeout();this.getPreviousCaption(time);this.setCaptionTimeout();}},cue:function(){return;}};
// Callback function for when the JW Player has loaded in the DOM
function jwPlayerReady(obj){var id=$(obj.ref).attr('id');var player=PlayerDaemon.getPlayer(id);var myplayer=jwplayer(obj.ref);player.init(myplayer);}